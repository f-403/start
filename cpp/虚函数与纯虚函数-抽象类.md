

# ğŸ“š C++ ä¸­çš„è™šå‡½æ•°ä¸æŠ½è±¡æœºåˆ¶æ€»ç»“

## ğŸ“– ç›®å½•

1. [è™šå‡½æ•°ï¼ˆVirtual Functionï¼‰](#1-è™šå‡½æ•°virtual-function)
2. [çº¯è™šå‡½æ•°ï¼ˆPure Virtual Functionï¼‰](#2-çº¯è™šå‡½æ•°pure-virtual-function)
3. [æŠ½è±¡æ–¹æ³•ï¼ˆAbstract Methodï¼‰](#3-æŠ½è±¡æ–¹æ³•abstract-method)
4. [æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰](#4-æŠ½è±¡ç±»abstract-class)
5. [æ€»ç»“å¯¹æ¯”è¡¨](#5-æ€»ç»“å¯¹æ¯”è¡¨)
6. [æ¥å£ç±»çš„æ‰©å±•å®ç°ï¼ˆå¯é€‰ï¼‰](#6-æ¥å£ç±»çš„æ‰©å±•å®ç°å¯é€‰)

---

## 1. è™šå‡½æ•°ï¼ˆVirtual Functionï¼‰

### âœ… æ¦‚å¿µ

è™šå‡½æ•°æ˜¯ä½¿ç”¨ `virtual` å…³é”®å­—ä¿®é¥°çš„æˆå‘˜å‡½æ•°ï¼Œæ”¯æŒ **è¿è¡Œæ—¶å¤šæ€ï¼ˆdynamic dispatchï¼‰**ã€‚å½“é€šè¿‡æŒ‡é’ˆæˆ–å¼•ç”¨è°ƒç”¨æ—¶ï¼Œè°ƒç”¨çš„å‡½æ•°ç”±å®é™…å¯¹è±¡ç±»å‹å†³å®šã€‚

### ğŸ§© ç¤ºä¾‹

```cpp
#include <iostream>
class Base {
public:
    virtual void speak() {
        std::cout << "Base speaking\n";
    }
};

class Derived : public Base {
public:
    void speak() override {
        std::cout << "Derived speaking\n";
    }
};

int main() {
    Base* ptr = new Derived();
    ptr->speak();  // è¾“å‡ºï¼šDerived speaking
    delete ptr;
}
```

---

## 2. çº¯è™šå‡½æ•°ï¼ˆPure Virtual Functionï¼‰

### âœ… æ¦‚å¿µ

çº¯è™šå‡½æ•°æ˜¯ä¸€ç§**æ²¡æœ‰å®ç°çš„è™šå‡½æ•°**ï¼Œåœ¨åŸºç±»ä¸­ç”¨ `= 0` è¡¨ç¤ºã€‚å®ƒå¼ºåˆ¶æ´¾ç”Ÿç±»å¿…é¡»å®ç°è¯¥å‡½æ•°ã€‚

### ğŸ“Œ è¯­æ³•

```cpp
virtual è¿”å›ç±»å‹ å‡½æ•°å(å‚æ•°) = 0;
```

### ğŸ§© ç¤ºä¾‹

```cpp
class Animal {
public:
    virtual void makeSound() = 0;  // çº¯è™šå‡½æ•°
};
```

---

## 3. æŠ½è±¡æ–¹æ³•ï¼ˆAbstract Methodï¼‰

### âœ… æ¦‚å¿µ

æŠ½è±¡æ–¹æ³•å°±æ˜¯â€œ**çº¯è™šå‡½æ•°**â€çš„å¦ä¸€ç§è¯´æ³•ã€‚å®ƒä¸èƒ½æœ‰å‡½æ•°ä½“ï¼Œæ´¾ç”Ÿç±»å¿…é¡»å®ç°å®ƒã€‚

> ğŸ’¡ æŠ½è±¡æ–¹æ³• = çº¯è™šå‡½æ•°

### ğŸ§© ç¤ºä¾‹åŒä¸Šï¼š

```cpp
virtual void makeSound() = 0;  // æŠ½è±¡æ–¹æ³•
```

---

## 4. æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰

### âœ… æ¦‚å¿µ

æŠ½è±¡ç±»æ˜¯åŒ…å«è‡³å°‘ä¸€ä¸ªçº¯è™šå‡½æ•°çš„ç±»ï¼Œ**ä¸èƒ½è¢«å®ä¾‹åŒ–**ã€‚å®ƒé€šå¸¸ä½œä¸ºæ¥å£æˆ–åŸºç±»è¢«ç»§æ‰¿ã€‚

### ğŸ“Œ ç‰¹ç‚¹

* å¯æœ‰æˆå‘˜å˜é‡ã€‚
* å¯æœ‰æ™®é€šå‡½æ•°æˆ–è™šå‡½æ•°ã€‚
* é€šå¸¸åªä½œä¸ºåŸºç±»ä½¿ç”¨ã€‚

### ğŸ§© ç¤ºä¾‹

```cpp
#include <iostream>
class Shape {
public:
    virtual void draw() = 0;  // æŠ½è±¡æ–¹æ³•

    void info() {
        std::cout << "This is a shape\n";
    }
};

class Circle : public Shape {
public:
    void draw() override {
        std::cout << "Drawing Circle\n";
    }
};

int main() {
    Shape* shape = new Circle();
    shape->draw();  // è¾“å‡ºï¼šDrawing Circle
    shape->info();  // è¾“å‡ºï¼šThis is a shape
    delete shape;
}
```

---

## 5. æ€»ç»“å¯¹æ¯”è¡¨

| é¡¹ç›®   | æ˜¯å¦æœ‰å®ç°   | æ˜¯å¦èƒ½å®ä¾‹åŒ–  | æ˜¯å¦æ”¯æŒç»§æ‰¿ | åŠŸèƒ½æè¿°        |
| ---- | ------- | ------- | ------ | ----------- |
| è™šå‡½æ•°  | âœ”ï¸ å¯é€‰å®ç° | âœ”ï¸ å¯ä»¥   | âœ”ï¸ æ”¯æŒ  | æ”¯æŒå¤šæ€è°ƒç”¨      |
| çº¯è™šå‡½æ•° | âŒ æ— å®ç°   | âŒ ä¸å¯å®ä¾‹åŒ– | âœ”ï¸ æ”¯æŒ  | å¼ºåˆ¶å­ç±»å®ç°      |
| æŠ½è±¡æ–¹æ³• | âŒ åŒä¸Š    | âŒ åŒä¸Š    | âœ”ï¸ åŒä¸Š  | çº¯è™šå‡½æ•°çš„å¦ä¸€ç§ç§°å‘¼  |
| æŠ½è±¡ç±»  | âœ”ï¸ å¯æœ‰æˆå‘˜ | âŒ ä¸å¯å®ä¾‹åŒ– | âœ”ï¸ æ”¯æŒ  | ç”¨äºå®šä¹‰æ¥å£å’Œæ¡†æ¶åŸºç±» |

---

## 6. æ¥å£ç±»çš„æ‰©å±•å®ç°ï¼ˆå¯é€‰ï¼‰

åœ¨ C++ ä¸­æ²¡æœ‰â€œinterfaceâ€å…³é”®å­—ï¼Œä½†å¯ä»¥é€šè¿‡çº¯è™šå‡½æ•°æ¨¡æ‹Ÿæ¥å£ã€‚

### ğŸ§© ç¤ºä¾‹ï¼š

```cpp
class IReadable {
public:
    virtual void read() = 0;
    virtual ~IReadable() = default;
};

class IWritable {
public:
    virtual void write() = 0;
    virtual ~IWritable() = default;
};

class File : public IReadable, public IWritable {
public:
    void read() override { std::cout << "Reading file\n"; }
    void write() override { std::cout << "Writing file\n"; }
};
```



# è™šå‡½æ•°ä¸çº¯è™šå‡½æ•°
```cpp
#include <iostream>
#include <map>

//çˆ¶ç±»ä¸­ä½¿ç”¨ virtual void func() = 0; å£°æ˜çº¯è™šå‡½æ•°ï¼Œå­ç±»å¿…é¡»å®ç°
//åªåœ¨çˆ¶ç±»ä¸­å†™virtualå°±è¡Œï¼Œ å­ç±»å¯å†™å¯ä¸å†™ï¼Œ ä½†å»ºè®®å†™ä¸Š
class Test {

    virtual void test() {
    }
    virtual void test2() = 0;
};
class Dog :public Test {
    virtual void test() {
        //ç›¸å½“äºé‡å†™
    }
    void test2() {
        //å¿…é¡»è¦é‡å†™å®ç°
    }
};
int main()
{
    //å½“è®¾ç½®ä¸ºè™šå‡½æ•°æ—¶ï¼Œ å¼•ç”¨æˆ–æŒ‡é’ˆä¼šæŸ¥æ‰¾ æ‰€å±ç±»å‹ 
    //å¦‚æœæ‰€å±æ˜¯ Dog, å°±ç”¨Dogçš„test(), å¦‚æœæ‰€å±æ˜¯Testå°±ç”¨Testçš„test()
    ////Test &a = new Dog()   Dogä¸­çš„testï¼ˆï¼‰ï¼Œ å› ä¸ºå¼•ç”¨çš„å€¼æ˜¯Dogç±»
    //Test &b = new Test()  çˆ¶ç±»ä¸­çš„testï¼ˆï¼‰ï¼Œ å› ä¸ºå¼•ç”¨çš„å€¼æ˜¯Testç±»
 
    //å½“æ²¡æœ‰è®¾ç½®è™šå‡½æ•°æ—¶ï¼Œ å¼•ç”¨æˆ–æŒ‡é’ˆè°ƒç”¨çš„ç›¸åº”å‡½æ•°ä¼šæ˜¯çˆ¶ç±»ä¸­çš„test() 
    //Test &a = new Dog()   çˆ¶ç±»ä¸­çš„testï¼ˆï¼‰ï¼Œ å› ä¸ºaæ˜¯çˆ¶ç±»å¼•ç”¨
    //Test &b = new Test()  çˆ¶ç±»ä¸­çš„testï¼ˆï¼‰ï¼Œ å› ä¸ºbæ˜¯çˆ¶ç±»å¼•ç”¨

    //ä¹Ÿå°±æ˜¯è®¾ç½®ä¸ºè™šå‡½æ•°åï¼Œ ä¼šæŒ‰å®é™…ç±»å‹è°ƒç”¨ç›¸åº”è™šå‡½æ•°ï¼Œ ä¸çˆ¶ç±»æ²¡æœ‰å…³ç³»
    /*
}

/*
//å…¶ä»–ä¾‹å­ï¼š
class Parent {
public:
    // è™šå‡½æ•°å£°æ˜
    virtual void print() {
        std::cout << "Parent::print()" << std::endl;
    }
    
    // éè™šå‡½æ•°ï¼ˆä»…ä½œå¯¹æ¯”ï¼‰
    void nonVirtualPrint() {
        std::cout << "Parent::nonVirtualPrint()" << std::endl;
    }
};

class Child : public Parent {
public:
    // é‡å†™çˆ¶ç±»çš„è™šå‡½æ•°
    void print() override {  // ä½¿ç”¨overrideæ˜¾å¼æ ‡è®°é‡å†™ï¼ˆC++11èµ·æ”¯æŒï¼‰
        std::cout << "Child::print()" << std::endl;
    }
    
    // é‡å†™çˆ¶ç±»çš„éè™šå‡½æ•°ï¼ˆä¸æ¨èè¿™æ ·åšï¼‰
    void nonVirtualPrint() {
        std::cout << "Child::nonVirtualPrint()" << std::endl;
    }
};

int main() {
    // åˆ›å»ºå­ç±»å¯¹è±¡
    Child child;
    
    // 1. é€šè¿‡å­ç±»å¯¹è±¡ç›´æ¥è°ƒç”¨ï¼ˆä¸è™šå‡½æ•°æ— å…³ï¼‰
    child.print();  // è¾“å‡ºï¼šChild::print()
    child.nonVirtualPrint();  // è¾“å‡ºï¼šChild::nonVirtualPrint()
    
    // 2. é€šè¿‡çˆ¶ç±»æŒ‡é’ˆè°ƒç”¨ï¼ˆå…³é”®ï¼šè™šå‡½æ•°å®ç°å¤šæ€ï¼‰
    Parent* parentPtr = &child;
    parentPtr->print();  // è¾“å‡ºï¼šChild::print()ï¼ˆåŠ¨æ€ç»‘å®šï¼‰
    parentPtr->nonVirtualPrint();  // è¾“å‡ºï¼šParent::nonVirtualPrint()ï¼ˆé™æ€ç»‘å®šï¼‰
    
    // 3. é€šè¿‡çˆ¶ç±»å¼•ç”¨è°ƒç”¨ï¼ˆåŒæ ·å®ç°å¤šæ€ï¼‰
    Parent& parentRef = child;
    parentRef.print();  // è¾“å‡ºï¼šChild::print()ï¼ˆåŠ¨æ€ç»‘å®šï¼‰
    parentRef.nonVirtualPrint();  // è¾“å‡ºï¼šParent::nonVirtualPrint()ï¼ˆé™æ€ç»‘å®šï¼‰
    
    return 0;
}   
    */
```
# C++ è™šå‡½æ•°ä¸æ™®é€šæˆå‘˜å‡½æ•°çš„åŒºåˆ«

```css
è°ƒç”¨å†³å®š	ç”±æŒ‡é’ˆ/å¼•ç”¨ç±»å‹å†³å®š	ç”±å®é™…å¯¹è±¡ç±»å‹å†³å®š
è™šå‡½æ•°ä¸æ™®é€šæˆå‘˜å‡½æ•°å·®åˆ«ï¼Œæ˜¯å½“è°ƒç”¨éƒ½æ˜¯**æŒ‡é’ˆæˆ–å¼•ç”¨**æ—¶ï¼Œæ‰æœ‰å·®åˆ«ï¼š
1.å½“æ˜¯è™šå‡½æ•°æ˜¯ï¼ŒæŒ‰æŒ‡é’ˆæˆ–å¼•ç”¨çš„å®é™…ç±»å‹è°ƒç”¨(æ³¨æ„ï¼Œå¦‚æœå­ç±»æ²¡é‡å†™çˆ¶ç±»çš„è™šå‡½æ•°ï¼Œ ä¹Ÿä¼šè°ƒç”¨çˆ¶ç±»çš„ç›¸åº”è™šå‡½æ•°)
2.æ™®é€šæˆå‘˜å°±åªè°ƒç”¨è‡ªèº«çš„æ–¹æ³•ï¼Œ å¦‚æœå®ƒæ²¡æœ‰é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œè€Œä¸”æ–¹æ³•æ˜¯ä»çˆ¶ç±»æ¥çš„ï¼Œä¼šå‘ä¸ŠæŸ¥æ‰¾çˆ¶ç±»æ–¹æ³•
3.çº¯è™šæ–¹æ³•å­ç±»å¿…å®šè¦é‡å†™(åƒå…¶ä»–è¯­è¨€ä¸­çš„æŠ½è±¡ç±»)
```
```cpp
class Base {
public:
    void normalFunc() { cout << "Base::normalFunc\n"; }
    virtual void virtualFunc() { cout << "Base::virtualFunc\n"; }
};

class Derived : public Base {
public:
    void normalFunc() { cout << "Derived::normalFunc\n"; }
    void virtualFunc() override { cout << "Derived::virtualFunc\n"; }
};

int main() {
    Base* b = new Derived();
    b->normalFunc();    // è¾“å‡º Base::normalFunc (é™æ€ç»‘å®š)
    b->virtualFunc();   // è¾“å‡º Derived::virtualFunc (åŠ¨æ€ç»‘å®š)
    delete b;
}

```


